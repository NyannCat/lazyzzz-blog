(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-202718d1"],{9189:function(t,e,a){},"91b6":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return s}));var i=a("b775");function n(t){return Object(i["a"])({url:"/attachment",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/attachment",method:"delete",params:t})}},bb23:function(t,e,a){"use strict";a("9189")},f6ba:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"text-align":"center"}},[a("el-card",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:1}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.visible=!0}}},[t._v("上传")])],1),a("el-col",{attrs:{span:4}},[a("el-select",{attrs:{placeholder:"请选择上传策略"},model:{value:t.args.type,callback:function(e){t.$set(t.args,"type",e)},expression:"args.type"}},t._l(t.options,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入关键词","suffix-icon":"el-icon-search"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getImage(t.data.current,t.data.size,t.keyword)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1)],1)],1),0===t.data.total?a("div",{staticStyle:{"text-align":"center","padding-top":"50px"}},[t._v(" 暂无数据 ")]):t._e(),a("el-row",{staticStyle:{padding:"10px"},attrs:{id:"uploads",gutter:20}},t._l(t.data.records,(function(e,i){return a("el-col",{key:i,attrs:{span:3}},[a("el-card",{staticClass:"image-container",attrs:{"body-style":{padding:"0px"}}},[a("el-image",{staticStyle:{height:"160px"},attrs:{src:e.path,fit:"cover"},on:{click:function(e){return t.handleDrawer(i)}}}),a("div",{staticStyle:{padding:"14px"}},[a("span",{staticStyle:{"font-size":"12px",color:"#999"}},[t._v(t._s(e.name))])])],1)],1)})),1),a("div",{staticStyle:{display:"block","text-align":"center"}},[a("el-pagination",{attrs:{"page-size":t.data.size,"page-sizes":[16,32,48],total:t.data.total,background:"",layout:"sizes, prev, pager, next"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),a("el-dialog",{attrs:{visible:t.visible,title:"上传文件"},on:{"update:visible":function(e){t.visible=e}}},[a("el-upload",{attrs:{action:t.action,data:t.args,"on-success":t.handleSuccess,"with-credentials":!0,headers:t.headers,drag:"",multiple:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])])])],1),a("el-drawer",{attrs:{"append-to-body":!0,visible:t.sync,direction:"rtl",title:"附件详情"},on:{"update:visible":function(e){t.sync=e}}},[a("el-image",{staticStyle:{height:"50%"},attrs:{src:t.record.path}}),a("el-divider",[a("i",{staticClass:"el-icon-picture-outline-round"})]),a("el-card",{staticStyle:{height:"50%"}},[a("div",{staticClass:"item text"},[a("div",[t._v("名称")]),t._v(" "+t._s(t.record.name)+" ")]),a("div",{staticClass:"item text"},[a("div",[t._v("类型")]),t._v(" "+t._s(t.record.mediaType)+" ")]),a("div",{staticClass:"item text"},[a("div",[t._v("引用连接")]),a("el-link",{attrs:{href:t.record.path,type:"primary"}},[t._v(" "+t._s(t.record.path)+" ")])],1),a("div",{staticStyle:{right:"0",bottom:"0",position:"absolute",padding:"20px"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.handleDelete(t.record.id)}}},[t._v("删除")])],1)])],1)],1)},n=[],s=(a("4160"),a("159b"),a("91b6")),r=a("5f87"),c={name:"index",created:function(){this.getImage(this.data.current,this.data.size,"")},data:function(){return{headers:{Authorization:Object(r["a"])()},options:[{value:"LOCAL",label:"本地"},{value:"QI_NIU_YUN",label:"七牛云"}],args:{type:"LOCAL"},data:{records:[{id:1,name:"",path:"",fileKey:"",mediaType:"",width:0,height:0,attachmentType:0}],total:0,size:16,current:1,pages:1},record:{id:"",name:"",path:"",mediaType:"",width:0,height:0,attachmentType:""},action:"/api/admin/attachment",visible:!1,keyword:"",sync:!1}},methods:{getImage:function(t,e,a){var i=this;Object(s["b"])({page:t,size:e,keyword:a}).then((function(t){i.data=t.data,i.data.records.forEach((function(t,e){0===t.attachmentType&&(t.path=""+t.path)}))}))},handleSuccess:function(t){200!==t.code?this.$message.error("上传失败, "+t.msg):(this.$message.success("上传成功"),this.getImage(this.data.current,this.data.size,""))},handleCurrentChange:function(t){this.data.current=t,this.getImage(t,this.data.size,this.keyword)},handleSizeChange:function(t){this.data.size=t,this.getImage(1,t,this.keyword)},handleDrawer:function(t){this.record=this.data.records[t],this.sync=!0},handleDelete:function(t){var e=this;this.$confirm("此操作将删除该附件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["a"])({id:t}).then((function(t){e.$message.success("附件删除成功"),e.getImage(e.data.current,e.data.size,"")}))}))}}},l=c,o=(a("bb23"),a("2877")),d=Object(o["a"])(l,i,n,!1,null,"2bb0b1d2",null);e["default"]=d.exports}}]);